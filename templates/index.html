{% extends "base.html" %} {% block title %}RealTop{% endblock %} {% block
content_main_class %}ratings-container ratings-home{% endblock %} {% block content_main %}
<div class="page-head">
  <p class="title_search">Featured Ratings</p>
</div>
{% if not current_user.is_authenticated %}
<p class="auth-hint" style="color: #6b7280; font-style: italic">
  Sign up or log in to add a rating.
</p>
{% endif %} {% if ratings %}
<input
  class="rating-list-toggle"
  id="featured-ratings-toggle"
  checked
  type="checkbox"
/>
<div class="rating-list-toggle-wrap">
  <div class="rating-list-collapsible">
    <ul class="rating-list">
    {% for rating in ratings %}
    <li
      onclick="window.location='/rating/{{ rating[0] }}'"
      class="{% if current_user.is_authenticated and rating[8] == current_user.username %}is-owner{% endif %}"
    >
      {% set pct = percent_map.get(rating[0]) if percent_map else None %} {% if
      pct %}
      <span class="rating-percent" aria-hidden="true">{{ pct }}%</span>
      {% endif %} {% set owner_username = rating[8] %}
      <div class="rating-item-left">
        <span class="avatar-wrap">
          {% if owner_pics and owner_username in owner_pics and
          owner_pics[owner_username] %}
          <img
            class="avatar"
            src="{{ owner_pics[owner_username] }}"
            alt="{{ owner_username }} avatar"
          />
          {% else %}
          <span class="avatar-initial">{{ owner_username[0]|upper }}</span>
          {% endif %}
        </span>
        <span class="rating-item-text">
          <small class="rating-owner">{{ owner_username }}</small>
          <strong>{{ rating[1] }}</strong>: {{ rating[2] }}<br />
          <small>
            Lyrics: {{ rating[3] }} | Beat: {{ rating[4] }} | Flow: {{ rating[5]
            }} | Melody: {{ rating[6] }} | Cohesive: {{ rating[7] }}
          </small>
        </span>
      </div>
      <span class="rating-item-actions" onclick="event.stopPropagation()">
        {% if current_user.is_authenticated and rating[8] ==
        current_user.username %}
        <span class="rating-action-group">
          <a
            href="/edit/{{ rating[0] }}"
            class="rating-action rating-action-edit"
            onclick="event.stopPropagation()"
            >Edit</a
          >
          <form
            action="/delete/{{ rating[0] }}"
            method="post"
            style="display: inline"
          >
            <button
              type="submit"
              class="rating-action rating-action-delete"
              onclick="event.stopPropagation(); return confirm('Are you sure you want to delete this rating?')"
            >
              Ã—
            </button>
          </form>
        </span>
        {% endif %} {% set reactions = reactions_map.get(rating[0]) if
        reactions_map else [] %} {% if reactions %}
        <span class="rating-reactions" aria-hidden="true">
          {% for emoji in reactions %}
          <span class="rating-emoji">{{ emoji }}</span>
          {% endfor %}
        </span>
        {% endif %}
      </span>
    </li>
    {% endfor %}
    </ul>
  </div>
  <label class="rating-list-toggle-label" for="featured-ratings-toggle">
    <span class="show-more">Show All</span>
    <span class="show-less">Show less</span>
  </label>
</div>
{% else %}
<p style="color: #6b7280; font-style: italic">No ratings yet.</p>
{% endif %} {% endblock %}
